pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
function _init() menu_init() end

function menu_init()
	_update=menu_update
	_draw=menu_draw

  make_menu()
end

function make_menu()
  menu={
    {label="start", action=game_init},
    {label="quit", action=menu_init}
  }
  selected=1
end

function menu_update()
  if (btnp(‚¨ÜÔ∏è)) selected=selected-1
  if (btnp(‚¨áÔ∏è)) selected=selected+1
  selected=flr((selected-1)%#menu)+1

  for i=1,#menu do
    if (btnp(üÖæÔ∏è) and i==selected) menu[i].action()
  end
end

function menu_draw()
  cls()
  for i=1,#menu do
    local color = i==selected and 8 or 7
    print(menu[i].label, 64-#menu[i].label*2, 64+i*8, color)
  end
end
-->8
function game_init()
	_update=game_update
	_draw=game_draw

  animation=0
end

function game_update()
	if (btnp(üÖæÔ∏è)) gameover_init()

  animation+=1
  -- animation%=100
  animation%=96
end

function game_draw()
  cls()

  -- display the animation frame
  print(animation, 0, 0, 7)


  -- draw the mountains from the spritesheet
  local mtain_w = 24
  local offset = (animation / 4 ) % mtain_w

  for x = 0, 127 + mtain_w, mtain_w do
    spr(1, x - offset, 64, 3, 2)
  end

  -- draw the ground
  rectfill(0, 120, 127, 127, 3)

  -- draw the road
  local road_w = 8
  local offset = (animation) % road_w

  for x = 0, 127 + road_w, road_w do
    spr(5, x - offset, 115)
  end

  -- draw the car
  car_x = 50
  car_y = 100
  spr(6, car_x, car_y, 4, 2)

  local wheel_r = flr(animation / 4) % 4
  local flip_y = flr(wheel_r / 2) * 2 - 1 == -1
  local wheel_spr = 10 + (flip_y and 1 - wheel_r % 2 or wheel_r % 2)
  
  spr(wheel_spr, car_x + 8, car_y + 14, 0.5, 0.5, false, flip_y)
  spr(wheel_spr, car_x + 25, car_y + 14, 0.5, 0.5, false, flip_y)
end

-->8
function gameover_init()
	_update=gameover_update
	_draw=gameover_draw
end

function gameover_update()
  if (btnp(üÖæÔ∏è)) menu_init()
end

function gameover_draw()
  cls()
  print("game over!")
end
__gfx__
00000000000000000000000000000000000000005555555500000000000000000000000000000000044000000440000000000000000000000000000000000000
00000000000000050000000000000000000000005577775500000000000000000454400000000000476400004674000000000000000000000000000000000000
00700700000000055000000000000000000000005577775500000000000000000454400000000000466400004664000000000000000000000000000000000000
00077000000000055500000000000000000000005555555500000000004454440454400000000000044000000440000000000000000000000000000000000000
00077000000000055500000000000000000000005555555500000000004454440454400000000000000000000000000000000000000000000000000000000000
00700700000000550550000000000000000000006666666600000000088888888888888000000000000000000000000000000000000000000000000000000000
00000000000000500055000000555000000000006666666600000000888667888866678800000000000000000000000000000000000000000000000000000000
00000000000005000005500005505000000000000000000000000008886666788666667880000000000000000000000000000000000000000000000000000000
00000000000005000000055055005500000000000000000000000008856666688566666680000000000000000000000000000000000000000000000000000000
00000000000050000000005550000500000000000000000000000088855555588855555588000000000000000000000000000000000000000000000000000000
00000000000550000000005500000550000000000000000000000088888888888888888888888800000000000000000000000000000000000000000000000000
00000000000500000000000000000550000000000000000000000888888888888558888888888880000000000000000000000000000000000000000000000000
00000000005000000000000000000550000000000000000000008888888888888888888888888886000000000000000000000000000000000000000000000000
00000000055000000000000000000055000000000000000000006688888888888888888888888886000000000000000000000000000000000000000000000000
00000000050000000000000000000005000000000000000000005688000088888888888880000880000000000000000000000000000000000000000000000000
00000000500000000000000000000005000000000000000000000880000008888888888800000080000000000000000000000000000000000000000000000000
__gff__
0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
